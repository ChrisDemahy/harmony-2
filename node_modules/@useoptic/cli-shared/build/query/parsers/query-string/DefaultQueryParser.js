"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.DefaultQueryParser = void 0;
const querystring_1 = __importDefault(require("querystring"));
const DefaultValueParser_1 = require("../values/DefaultValueParser");
class DefaultQueryParser {
    parse(rawQueryString) {
        const values = this.parseToKeysAndValues(rawQueryString);
        const final = {};
        Object.entries(values).map((i) => {
            const [key, values] = i;
            //@ts-ignore
            final[key] = DefaultValueParser_1.DefaultValueParserInstance.parse(key, values);
        });
        return final;
    }
    parseToKeysAndValues(rawQueryString) {
        const final = {};
        Object.entries(querystring_1.default.parse(rawQueryString)).map((i) => {
            const [key, value_s] = i;
            if (Array.isArray(value_s)) {
                final[key] = value_s;
            }
            else {
                final[key] = [value_s];
            }
        });
        return final;
    }
}
exports.DefaultQueryParser = DefaultQueryParser;
